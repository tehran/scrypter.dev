---
layout: single
title: Using PowerShell as a Starting Point for Comparing GPOs
excerpt: 
permalink: /2012/04/using-powershell-as-starting-point-for.html
tags: 
- active directory
- audit
- gpmc
- group policy
- powershell
- video
published: true
comments: true
---
<a href="http://www.scriptlogic.com/smbit/video/using-powershell-as-a-starting-point-for-comparing-gpos?utm_source=feedburner&amp;utm_medium=feed&amp;utm_campaign=Feed%3A+smbit+%28ScriptLogic+SMBIT%29" target="_blank"><span style="font-family: inherit;">source</a>
<span style="font-family: inherit;">

<span style="font-family: inherit;"><iframe allowfullscreen="" frameborder="0" height="360" src="http://www.youtube.com/embed/qoocEgmHUEg" width="640"></iframe>
<span style="font-family: inherit;">


<h2 style="background-color: white; border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: #333333; font: inherit; line-height: 0.923em; margin-bottom: 0.3em; margin-left: 0px; margin-right: 0px; margin-top: 0px; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline;">  <span style="font-family: inherit;">Video Transcript

<div style="background-color: white; border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: #484848; font: inherit; line-height: 22px; margin-bottom: 1.5em; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline;"><span style="font-family: inherit;">Comparing two Group Policy Objects can be pretty tricky with the native tools. Here in the Group Policy Management console or GPMC I have created two different GPO's, test 1 and test 2. Now if we open one up each of these only setting a couple of settings. You will find it under Computer Configuration/Polices/Windows Settings/Security Settings/Event Log. What I have done is set the Retain security log in this one to 75 days and the other test GPO to 7 days. Then both of them set the retention method for security log to By days.<div style="background-color: white; border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: #484848; font: inherit; line-height: 22px; margin-bottom: 1.5em; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline;"><span style="font-family: inherit;">Right here in the GPMC there is nothing I can really do to compare these two things. What I have done is hop on Google, I punched in compare GPO and I found this script that was written by Ed Wilson, the scripting guy at Microsoft. He has helpfully posted this in the repository and what I have done is take the scripts default parameters to reflect my environment. I provided the domain name, the name of the controller, my two GPO's, and then the folder where I want the comparison information to be written.<div style="background-color: white; border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: #484848; font: inherit; line-height: 22px; margin-bottom: 1.5em; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline;"><span style="font-family: inherit;">You do not have to set that information, it is possible to provide all of those perimeters when you run the script. For example, we will hop down here. There is the name of the script. Now because I have set all of those perimeters to what I want them to be by default I do not need to specify the GPO names, or the domain name, or the server names, or any of that. But I do need to specify either -computer or -user, based on which side of the GPO, the computer settings or the user settings, I want to compare.<div style="background-color: white; border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: #484848; font: inherit; line-height: 22px; margin-bottom: 1.5em; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline;"><span style="font-family: inherit;">Running this, it is actually outputting both GPO's test 2 and test 1 to an xml file and it is indicating that both of these GPO's change the same settings. I see AuditLogRetentionPeriod and RetentionDays. Unfortunately because of the way this output is created I cannot really tell that it is the security audit log that was changed. I see both of them changed that setting, but I do not actually see what they changed it to just with that default output.<div style="background-color: white; border-bottom-width: 0px; border-color: initial; border-image: initial; border-left-width: 0px; border-right-width: 0px; border-style: initial; border-top-width: 0px; color: #484848; font: inherit; line-height: 22px; margin-bottom: 1.5em; padding-bottom: 0px; padding-left: 0px; padding-right: 0px; padding-top: 0px; vertical-align: baseline;"><span style="font-family: inherit;">This is why some people will start looking at third party tools. If you hop into Google or your favorite search engine and type compare GPO tool, you will find plenty of different results. The key and one of the things I discuss in the article,<a href="http://www.scriptlogic.com/smbit/article/native-methods-for-comparing-group-policy-objects" style="-webkit-tap-highlight-color: rgb(12, 127, 206); color: #0c7fce; text-decoration: none;">Native Methods for Comparing Group Policy Objects</a>, that accompanies this video is in deciding exactly what you are going to do with that comparison, because different tools provide you with that information in different ways. For example, if you just need a quick check of what settings two GPO's do, well then this little script can do that for you. If you need to dive deeper and maybe get a color coded change management report that shows what values are different from GPO to GPO well, then you are going to have to either do more work with something like PowerShell or find some tools that implement that for you.
